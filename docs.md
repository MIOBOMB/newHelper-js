Базовая документация (если поможет)
- Внимание! документация предоставлена к внутренней версии 2.0.9, возможны расхождения с версией 2.1, рекомендуем сверяться с исходным кодом

# Роутер (_.link)
Роутер здесь завязан на особенном от популярных решений поведении. Берётся query строка, разбивается по "&", и из полученного массива дальше с этой строкой роутер работает обособленно. Сначала идёт элемент 0 который отвечает за страницы и вложенность, последующие элементы являются командами, на них вы можете навешать открытие окон, модалки, или просто всякие дебаг штучки (например отключение проверки наличия капчи при логине или смену языка)
## API:
### Конфиг:
- basePage() - fallback страница на случай если страницы не существует, рекомендую ставить клиентскую страницу "404"
- defTitle - отображаемое названия вкладки при открытии страницы
- actions - словарь функций с ссылками
- commands - словарь функций команд
### Базовые методы:
- set(page, title) - устанавливает страницу
- add(cmd) - добавляет команду в ссылку (если есть повторка добавления не будет)
- remove(cmd) - удаляет команду из ссылки, если она есть
### Внутренние методы/свойства:
- get() - обработать ссылку и вызвать нужные страницы и команды (допустим открыть ту или иную страницу, и вызвать  модалки если их нет). Рекомендуется вызывать при старте приложения, автоматически срабатывает при событии popstate
- _i - флаг запрещающий функции set() ставить новую страницу, по умолчанию true, но после каждого вызова set() становится false
- _cmd - прослойка для сохранения команд между popstate событиями
- compileLink() - возвращает скомпилированную ссылку в формате ["ключ=значение","ключ=значение"]. Не рекомендуется к использованию вообще
### Пример конфигурации (Object Hub):
```
_.link.defTitle = 'Object Hub';
_.link.basePage = ()=>{innerMain(pageMain())};
_.lang.vars = {
	'helperStrVer':helperStrVer,
	'helperBuildNum':helperBuildNum,
	'helperUrl':helperUrl
};
_.link.commands = {
	en: ()=>        {_.lang.replace('EN',1)},
	ru: ()=>        {_.lang.replace('RU',1)},
	ua: ()=>        {_.lang.replace('UA',1)},
	de: ()=>        {_.lang.replace('DE',1)},
	dev: ()=>       {debugWindow()},
	ignoreCap: ()=> {ignoreCap = true}
};
_.link.actions = {
	'': ()=>                 {innerMain(pageMain())},
	find: ()=>               {pageFind()},

	camp: (campId)=>         {getCamp(campId)},
	show: (showId)=>         {getShow(showId)},
	pere: (pereId)=>         {getPere(pereId)},
	news: ()=>               {globalNews()},
	'news/': {
		'': ()=>             {globalNews()},
		comms: (postId)=>    {let d = postId.split('|');getNewsWithComments(d[0], d[1], d[2])},
		list: (gdpsId)=>     {let d = gdpsId.split('|');helperNews(d[0], d[1])},
	},
	about: ()=>              {innerMain(helperAbout())},

	profiles: (userId)=>     {otherProfile(userId,'pageFind(0)')},
	'profiles/': {
		'': (userId)=>       {otherProfile(userId,'pageFind(0)')},
		camps: (userId)=>    {otherProfile(userId,'pageFind(0)',otherCampsWindow)},
		shows: (userId)=>    {otherProfile(userId,'pageFind(1)',otherShowsWindow)},
		peres: (userId)=>    {otherProfile(userId,'pageFind(2)',otherPeresWindow)},
		wikis: (userId)=>    {otherProfile(userId,'pageFind(0)',otherWikisWindow)},
	},
};
```

# Ленивый загрузчик (_.lazy)
Ленивый загрузчик скриптов позволяет подгружать ненужные прямо сейчас части кода потом (как пример, панель управления вики в object hub подгружается только когда пользователь открывает её). Также позволяет грузить любые newHelper.js-совместимые библиотеки, но об этом позже
## API:
### Базовые методы:
- load(url, ...args) - функция немедленной загрузки скрипта, как пример подгрузка капчи на object hub работает напрямую через неё. Возвращает промис, резолв которого происходит сразу после загрузки скрипта
- register(scr, funcs) - регистрация lazy функций в конфиге, где первым аргументом идёт ссылка на ленивый скрипт, а вторым массив функций-точек входа (названия функций должны идти как строки). При регистрации функций пишет в консоль какие функции были зарегистрированы. Вешайта функции-точки входа на window, иначе функцмя объявится не глобально и у вас будет ошибка!
### Внутренние свойства/методы:
- _(scr, fn) - надстройка для register() которая является прокси для загрузки.
- loaded- объект с загруженными скриптами, каждая загруженная ссылка может быть промисом, что означает что она ещё загружается, или true
### Пример конфигурации (и запуска сайта, Object Hub):
```
_.lazy.register('./static/devpanel.js',[
	'debugWindow'
]);
_.lazy.register('./static/publicWiki.js',[
	'pageGuides',
	'getGuide',
]);
_.lazy.load('./static/ojhub.js')
	.then(e=>{
		reStart();
	});
```

# Локализация (_.lang)
Локализация в newHelper.js реализована довольно просто но мощно
## API:
### Конфиг:
- addr - строка с адресом на папку где хранятся все языковые пакеты, обязательно перезаписывать в конфиге
- vars - Объект подменяемых переменных, где в качестве ключа вы указываете нужную для подстановки переменную
- main - Словарь с языковым пакетом
### Базовые методы:
- load(name) - скачивает языковой пакет
- parse(packet) - подменяет переменные из vars на их значения в пакете. Учтите что ваши ключи из vars должны быть обёрнуты знаками плюса (+переменная+)
- replace(name) - немедленно скачать языковой пакет и распарсив его перевести сайт
- win(i) - получить значение ключа пакета для окон
### Методы получения значений пакета:
ВНИМАНИЕ! для краткости кода все методы ниже кроме from() самостоятельно формируют кусок html, принято такое решение было для краткости кода.
- from(i) - получить голое значение ключа или сам ключ если его нет
- text(i) - получить значение ключа пакета для обычных текстовых элементов
- submit(i) - получить значение ключа пакета для <input type=submit>
- input(i) - получить значение ключа пакета для обычного инпута
- textarea(i) - получить значение ключа пакета для обычной textarea
- img(i) - получить значение ключа пакета для картинки, где значением является адрес на картинку (будет полезно для создания меню языков, где языки будут флагами)
### Пример конфига и использования:
```
_.lang.addr = `./languages/`;
await _.lang.replace('RU'); // скачает `./languages/RU.json`
console.log(_.lang.main) // Object {hi:'Привет мир!', langImage:'./static/ru.png'}

console.log(`<h1${_.lang.text('hi')}/h1>`) // <h1 data-trans="hi">Привет мир!</h1>
console.log(`<img${_.lang.img('langImage')}>`) // <img data-trans="langImage" src="./static/ru.png">

await _.lang.replace('EN');

console.log(`<h1${_.lang.text('hi')}/h1>`) // <h1 data-trans="hi">Hello world!</h1>
console.log(`<img${_.lang.img('langImage')}>`) // <img data-trans="langImage" src="./static/en.png">
```

# Кастомные горячие клавишы (_.hotkeys)
Горячие клавишы реализованы через систему "зажал отпустил", каждое действие вызывает колбек, но вы можете сделать и обычные хоткеи оставив дейсвтие "отпустил" пустым
## API:
### Конфиг:
- keys - Объект ключей, в теории его можно перезаписывать и устанавливать значение из localStorage, но на практике пока никто так не делал
- on(combo, press, release) - Зарегистрировать горячую клавишу на сочетание, принимает в качестве имени клавишы KeyboardEvent.code, комбинируется разделителем + ('ShiftLeft+KeyZ' для зажатия шифта и клавишы "я"), вторым аргументом идёт колбек на нажатие или зажатие, третьим аргументом идёт колбек на отжатие
- off(combo) - Удалить все хоткеи повешанные на комбинацию
Если вы хотите сделать хоткей который будет работать на простое нажатие, просто оставьте третий аргумент в on() пустым
### Внутренние методы:
- _parse - распарсить комбинацию в массив клавиш
- _match - проверить зажаты ли нужные клавишы
- _init - запустить движок путём навешивания чтения событий для keyDown и keyUp, плюсом идёт событие 'blur' которое отключает все запущенные хоткеи
- _i - внутренная переменная для _init которая не даёт запустить движок дважды
### Пример конфига (Object hub):
```
_.hotkeys.on('ShiftLeft + F1', debugWindow);
_.hotkeys.on(
	'ShiftLeft+KeyZ',
	()=>keyBindsList(),
	()=>_.$.qa('[keybindslist]').forEach(e=>_.win.close(e.id))
);
```


# Движок окон (_.win)
Вот она главная фишка библиотеки! Учтите что мы НЕ советуем вам переопределять встроенные методы, т.к. у движка окон ещё большой задел под оптимизацию кода или расширение функционала, никто же ведь не хочет словить краш на старте вашего сайта из-за появления возможности переименовывать окна?
## API:
### Конфиг:
- manager - DOM элемент с открытыми окнами
- hider - DOM элемент с открытыми окнами
- winAttrs - Атрибуты открытых окон, рекомендуем указывать класс с анимацией окна и стилии
- dragAttrs - Атрибуты элемента драга
- titleAttrs - Атрибуты назнвания окна
- renameAttrs - Атрибуты инпута при переименовании окна
- btnAttrs - Атрибуты кнопок окон, рекомендую отключать задний фон, желательно через классы
- defBtns - Кастомные кнопки, по умолчанию уже имеет кнопки скрытия, разворота на весь экран и закрытия
- hiderAttrs - Атрибуты кнопок для раскрытия свёрнутых окон
- animOpen - Название класса с анимацией открытия
- animClose - Название класса с анимацией закрытия
- animHide - Название класса с анимацией сворачивания окна
- animShow - Название класса с анимацией разворачивания окна
- animFullOn - Название класса с входом в режим полного окна
- animFullOff - Название класса с выходом из режима полного окна
### Базовые методы:
- open(name, content, customAttrs) - Открыть окно
- toggleFull(winId) - развернуть окно на весь экран, если уже развернуто вернуть в исходное состояние
- setTitle(winId, newTitle) - Переименовать окно. Осторожно, при переименовании окна смена языка не сможет изменить название окна
- close(winId) - закрыть окно
- hide(winId) - скрыть окно и создать "хайдер"
- show(winId) - развернуть окно и удалить "хайдер"
### Внутренние методы на this:
- _winBtn(winIdtext, func) - кнопка окна, в будущем функционал кнопок будет расширен для создания кастомных кнопок
- _hiderBtn(text) - кнопка для разворота окна
- _initWin() - запустить драггер окна
- _ID() - сгенерировать уникальный айди окна
Внешние свойства:
- _.wins - коллекция открытых окон

# Ошибки (_.err)
Ошибки обрабатываются всегда и глобально несмотря ни на что, только если они были пойманы обработчиками. Рекомендую загружать другие библиотеки через ленивую загрузку (обычным load() прямо в конфиге()) чтобы потом модуль ошибок не упадал в саморекурсию из-за отсутствия в стеке разделителя "&helper:" 
## API:
### Базовые свойства/методы:
- errors - объект со всеми ошибками случившимися за сессию
- _c - счётчик ошибок
- log(err, addr) - сохраняет ошибку и добавляет к счётчику единичку
### Методы отлова (по умолчанию глобальные, имеют возможность находить точную строку ошибки):
- handleGlobal(message, source, line, column, error) - словить обычную ошибку и сохранить её
- handleRejection(e) - словить отклонение промиса если не было поймано
### Конфиг:
- print(errID, err, addr) - ваш кастомный обработчик ошибок. Мы вам очень рекомендуем для дев среды назначить вот такой обработчик:
```js
let windowBtns = [
	['COPY ERROR',   `navigator.clipboard.writeText(_.$.id('errText{errID}').innerText)`],
	['FULL RESTART', `location.reload()`],
	// ваши прочие нужные методы, например перезапуск приложения без перезагрузки страницы, или сброс storage и перезапуск приложения
];
_.err.print = (errID, errText, addr = '')=>{
	let buttonErr = (i, clck)=>`<button style=background-color:#333 onclick="${clck}">${i}</button> `,
		buttons = '',
		html = _.html`<div id=debug${errID}>
				<p align=center>DEBUG INFO</p>
				ERROR<br>
					<pre style=width:100%;white-space:pre-line id=debugMega${errID}></pre>
				<br><br>
				<center id=windows${errID}>
				</center>
			</div>`;
	console.log(html);
	_.$.q('#debugMega'+errID, html).textContent = `LOCATION: ${location}\n`+errText+`\n`+
	(addr === '' ? '' : `\n${addr}`);
	
	windowBtns.forEach(btn=>{
		buttons += buttonErr(btn[0], btn[1].replaceAll('{errID}', errID));
	});
	_.$.q('#windows'+errID, html).innerHTML = buttons;

	let winId = _.win.open('debug'+errID,
		html
	, `iserror style=width:300px;height:350px`);
```

# Прочие утилиты, которым не особо нужно описание:
## http-клиент на базе xhr
- defaultHeaders - Хедеры которые всегда будут назначаться при запросах, вы можете назначить туда токен пользователя
- req(method, url, data, headers, fileProgressElement) - сделать запрос с различным методом, fileProgressElement требуется указывать лишь в случае если нужно отслеживать прогресс загрузки файла, не рекомендуется задавать свойства min и max
## DOM утилиты:
- _.$.q(i,p=document), алиас к document.querySelector(i,p), где p может быть любым DOM пространством
- _.$.qa, алиас к document.querySelectorAll(i,p), где p может быть любым DOM пространством
- _.$.id(i) - алиас к document.getElementById(i), у неё нет аргумента p так как он не работает в других пространствах имён
- _.html - превратить шаблонную строку в DOM элемент(ы)
- _.storage - обычная изолирующая обёртка над классом Storage, имеет почти идентичные методы, разве что прямое обращение и перезапись недоступны

# Плагины?..
Да! и ещё как! поскольку newHelper.js является обычным набором javascript инструментов, помещённых в объект "_" вы можете спокойно загрузить вообще любой скрипт через _.lazy, даже не просто загрузить а повешать на лень если они вам не нужны прямо сейчас!

# Чеклист конфигов
_.link
- basePage() - fallback страница на случай если страницы не существует
- defTitle - отображаемое названия вкладки при открытии страницы
- actions - словарь функций с ссылками
- commands - словарь функций команд

_.lazy
- load(url, ...args) - функция немедленной загрузки скрипта
- register(scr, funcs) - регистрация lazy функций в конфиге

_.lang
- addr - строка с адресом на папку где хранятся все языковые пакеты
- vars - Объект подменяемых переменных
- main - Словарь с языковым пакетом

_.hotkeys
- keys - Объект ключей
- on(combo, press, release) - Зарегистрировать горячую клавишу на сочетание
- off(combo) - Удалить все хоткеи повешанные на комбинацию

_.err
- print(errID, err, addr) - ваш кастомный обработчик ошибок

_.http
- defaultHeaders

_.storage
сам себе конфиг

_.win
- manager - DOM элемент с открытыми окнами
- hider - DOM элемент с открытыми окнами
- winAttrs - Атрибуты открытых окон
- dragAttrs - Атрибуты элемента драга
- titleAttrs - Атрибуты назнвания окна
- renameAttrs - Атрибуты инпута при переименовании окна
- btnAttrs - Атрибуты кнопок окон
- defBtns - Кастомные кнопки, по умолчанию уже имеет кнопки
- hiderAttrs - Атрибуты кнопок для раскрытия свёрнутых окон
- animOpen - Название класса с анимацией открытия
- animClose - Название класса с анимацией закрытия
- animHide - Название класса с анимацией сворачивания окна
- animShow - Название класса с анимацией разворачивания окна
- animFullOn - Название класса с входом в режим полного окна
- animFullOff - Название класса с выходом из режима полного окна
